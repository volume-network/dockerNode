(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d91408f"],{"107c":function(t,e,s){"use strict";e["a"]={props:{value:{type:Boolean,required:!0}},methods:{hideModal:function(){this.$emit("input",!1)}}}},"2e3f":function(t,e,s){"use strict";var n=s("aff9"),a=s("5f72"),o=s("365c"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"result"},[s("div",{staticClass:"result-icon__wrap",class:{success:"success"===t.result}},["success"===t.result?s("i",{staticClass:"el-icon-check"}):s("i",{staticClass:"el-icon-close"})]),s("span",{staticClass:"result-content"},[t._v(t._s("success"===t.result?t.$t("myaccount.broadcastSuccess"):t.$t("myaccount.broadcastFail")))]),s("el-button",{staticClass:"result-button",attrs:{type:"primary"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("myaccount.close")))])],1)},r=[],c={name:"Result",props:{title:{type:String,required:!0},result:{type:String,default:"success"}}},l=c,u=(s("b612"),s("2877")),d=Object(u["a"])(l,i,r,!1,null,"072d6b1e",null),m=d.exports;e["a"]={components:{Result:m},data:function(){return{disabledSendButton:!1,isSubmit:!1,result:"",resultTitle:""}},computed:{formattedAccountOverview:function(){return this.$store.getters.formattedAccountOverview}},methods:{send:function(){var t=this;this.$refs.sendForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.submit()})},broadcastTransaction:function(t){var e=this,s=n["a"].signBytes(t,this.$store.state.account.mnemonic),i=n["a"].verifyBytes(s,t,this.$store.state.account.publicKey);if(i){var r=n["a"].signTransactionBytes(t,s);return new Promise(function(t,s){o["d"]({transactionBytes:r}).then(function(s){e.$store.dispatch("getAccountOverview"),t(s)}).catch(s)})}Object(a["Message"])({showClose:!0,message:"签名验证未通过",type:"error"})}}}},"379e":function(t,e,s){},"4c4f":function(t,e,s){"use strict";var n=s("9653"),a=s.n(n);a.a},"4db3":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"miner-management"},[s("vs-container",[s("vs-header",{staticClass:"vs-header",attrs:{title:t.$t("myaccount.minerManagement")}},[s("el-button",{attrs:{slot:"right",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.addMiner},slot:"right"},[t._v(t._s(t.$t("myaccount.auth")))])],1),s("vs-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"vs-main"},[s("h6",{staticClass:"vs-main__title"},[t._v(t._s(t.$t("myaccount.authMiners")))]),s("div",{staticClass:"el-table__wrap"},[s("el-table",{attrs:{data:t.minerList}},[s("el-table-column",{attrs:{width:"220",align:"left",prop:"accountRS",label:t.$t("myaccount.address")}}),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"totalCap",label:t.$t("myaccount.capacity"),sortable:""}}),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"totalPledged",sortable:"",label:t.$t("myaccount.staked")}}),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"blockNum",sortable:"",label:t.$t("myaccount.blockForged")}}),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"blockReward",sortable:"",label:t.$t("myaccount.blockEarning")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("toThousands")(e.row.blockReward))+"\n            ")]}}])}),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"pledgedReward",sortable:"",label:t.$t("myaccount.stakingEarning")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("toThousands")(e.row.pledgedReward))+"\n            ")]}}])}),s("el-table-column",{attrs:{align:"right",label:t.$t("myaccount.operation")},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{staticClass:"button-cancel",attrs:{size:"small",plain:""},on:{click:function(s){return t.revokeMiner(e.row.accountRS)}}},[t._v(t._s(t.$t("myaccount.cancelAuth")))])]}}])})],1)],1)])],1),s("el-dialog",{attrs:{visible:t.isShowDialog,"show-close":!1,"destroy-on-close":!0,"custom-class":"vs-dialog",width:"380px"},on:{"update:visible":function(e){t.isShowDialog=e}}},[s("MinerAdd",{attrs:{action:t.minerType,address:t.tempAddress},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}})],1)],1)},a=[],o=(s("96cf"),s("3b8d")),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-content__wrap"},[s("div",{staticClass:"dialog-content"},[t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?s("h4",{staticClass:"dialog-content__title"},[t._v(t._s(t.$t("myaccount.auth")))]):s("h4",{staticClass:"dialog-content__title"},[t._v(t._s(t.$t("myaccount.cancelAuth")))]),t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?s("el-form",{ref:"sendForm",staticClass:"dialog-content__body",attrs:{model:t.form,rules:t.rules}},[s("el-form-item",{attrs:{prop:"address"}},[s("el-input",{attrs:{size:"small",placeholder:t.$t("myaccount.errorAddressTips")},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}},[s("template",{slot:"prepend"},[t._v(t._s(t.$t("myaccount.minerAddress")))]),s("div",{attrs:{slot:"suffix"},slot:"suffix"})],2)],1)],1):s("div",{staticClass:"revoke-tips"},[t._v("\n      确认取消该矿工授权\n    ")]),s("div",{staticClass:"dialog-content__footer"},[t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?s("div",{staticClass:"vs-buttons"},[s("el-button",{attrs:{disabled:t.disabledSendButton,type:"primary"},on:{click:t.send}},[t._v(t._s(t.$t("myaccount.ok")))]),s("el-button",{attrs:{disabled:t.disabledSendButton,type:"info"},on:{click:t.hideModal}},[t._v(t._s(t.$t("myaccount.cancel")))])],1):s("div",{staticClass:"vs-buttons"},[s("el-button",{attrs:{disabled:t.disabledSendButton,type:"primary"},on:{click:t.submit}},[t._v("取消授权")]),s("el-button",{attrs:{disabled:t.disabledSendButton,type:"info"},on:{click:t.hideModal}},[t._v("暂不")])],1)])],1)])},r=[],c=s("107c"),l=s("2e3f"),u=s("365c"),d=s("aff9"),m=s("5f72"),p={name:"MinerAdd",props:{action:{type:String,required:!0},address:{type:String}},mixins:[c["a"],l["a"]],data:function(){return{disabledSendButton:!1,form:{address:""}}},computed:{rules:function(){return{address:[{required:!0,message:this.$t("myaccount.inputMinerAddress"),trigger:"blur"}]}},HANDLER_MINER_TYPES:function(){return u["a"]}},methods:{submit:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,s,n,a,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.address,this.action===u["a"].grantPoolMiner&&(e=this.form.address),console.log(e),s=[{miner:d["a"].createAccountIdByAddress(e)}],n=d["a"].signParams(s,this.$store.state.account.mnemonic),a={account:JSON.stringify(s),pool:this.$store.state.account.address,publicKey:this.$store.state.account.publicKey,signature:n},this.disabledSendButton=!0,o=this.action===u["a"].grantPoolMiner?"增加":"取消",t.prev=8,t.next=11,u["q"](a,this.action);case 11:this.$store.dispatch("getAccountOverview"),m["Message"].success("".concat(o,"成功")),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](8),m["Message"].success("".concat(o,"失败"));case 18:return t.prev=18,this.disabledSendButton=!1,this.hideModal(),t.finish(18);case 22:case"end":return t.stop()}},t,this,[[8,15,18,22]])}));function e(){return t.apply(this,arguments)}return e}()}},f=p,h=(s("4c4f"),s("2877")),v=Object(h["a"])(f,i,r,!1,null,"02399372",null),b=v.exports,g={name:"MinerManagement",components:{MinerAdd:b},data:function(){return{loading:!1,isShowDialog:!1,tempAddress:"",minerType:u["a"].grantPoolMiner}},computed:{minerList:function(){return this.$store.state.minerList}},created:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("getMinerList");case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.error(t.t0);case 9:return t.prev=9,this.loading=!1,t.finish(9);case 12:case"end":return t.stop()}},t,this,[[0,6,9,12]])}));function e(){return t.apply(this,arguments)}return e}(),methods:{addMiner:function(){this.minerType=u["a"].grantPoolMiner,this.isShowDialog=!0},revokeMiner:function(t){this.minerType=u["a"].revokePoolMiner,this.tempAddress=t,this.isShowDialog=!0}}},_=g,y=(s("7cb9"),Object(h["a"])(_,n,a,!1,null,"e2f0dd5e",null));e["default"]=y.exports},"7cb9":function(t,e,s){"use strict";var n=s("d684"),a=s.n(n);a.a},9653:function(t,e,s){},b612:function(t,e,s){"use strict";var n=s("379e"),a=s.n(n);a.a},d684:function(t,e,s){}}]);