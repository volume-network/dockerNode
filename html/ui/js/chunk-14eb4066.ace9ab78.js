(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14eb4066"],{"00e6":function(t,e,n){"use strict";var s=n("c417"),a=n.n(s);a.a},"107c":function(t,e,n){"use strict";e["a"]={props:{value:{type:Boolean,required:!0}},methods:{hideModal:function(){this.$emit("input",!1)}}}},"2e3f":function(t,e,n){"use strict";var s=n("aff9"),a=n("5f72"),o=n("365c"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"result"},[n("div",{staticClass:"result-icon__wrap",class:{success:"success"===t.result}},["success"===t.result?n("i",{staticClass:"el-icon-check"}):n("i",{staticClass:"el-icon-close"})]),n("span",{staticClass:"result-content"},[t._v(t._s("success"===t.result?t.$t("myaccount.broadcastSuccess"):t.$t("myaccount.broadcastFail")))]),n("el-button",{staticClass:"result-button",attrs:{type:"primary"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("myaccount.close")))])],1)},r=[],c={name:"Result",props:{title:{type:String,required:!0},result:{type:String,default:"success"}}},l=c,u=(n("b612"),n("2877")),d=Object(u["a"])(l,i,r,!1,null,"072d6b1e",null),p=d.exports;e["a"]={components:{Result:p},data:function(){return{disabledSendButton:!1,isSubmit:!1,result:"",resultTitle:""}},computed:{formattedAccountOverview:function(){return this.$store.getters.formattedAccountOverview}},methods:{send:function(){var t=this;this.$refs.sendForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.submit()})},broadcastTransaction:function(t){var e=this,n=s["a"].signBytes(t,this.$store.state.account.mnemonic),i=s["a"].verifyBytes(n,t,this.$store.state.account.publicKey);if(i){var r=s["a"].signTransactionBytes(t,n);return new Promise(function(t,n){o["d"]({transactionBytes:r}).then(function(n){e.$store.dispatch("getAccountOverview"),t(n)}).catch(n)})}Object(a["Message"])({showClose:!0,message:"签名验证未通过",type:"error"})}}}},"379e":function(t,e,n){},"4db3":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"miner-management"},[n("vs-container",[n("vs-header",{staticClass:"vs-header",attrs:{title:t.$t("myaccount.minerManagement")}},[n("el-button",{attrs:{slot:"right",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.addMiner},slot:"right"},[t._v(t._s(t.$t("myaccount.auth")))])],1),n("vs-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"vs-main"},[n("h6",{staticClass:"vs-main__title"},[t._v(t._s(t.$t("myaccount.authMiners")))]),n("div",{staticClass:"el-table__wrap"},[n("el-table",{attrs:{data:t.minerList}},[n("el-table-column",{attrs:{width:"220",align:"left",prop:"accountRS",label:t.$t("myaccount.address")}}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"totalCap",label:t.$t("myaccount.capacity"),sortable:""}}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"totalPledged",sortable:"",label:t.$t("myaccount.staked")}}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"blockNum",sortable:"",label:t.$t("myaccount.blockForged")}}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"blockReward",sortable:"",label:t.$t("myaccount.blockEarning")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("toThousands")(e.row.blockReward))+"\n            ")]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"pledgedReward",sortable:"",label:t.$t("myaccount.stakingEarning")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("toThousands")(e.row.pledgedReward))+"\n            ")]}}])}),n("el-table-column",{attrs:{align:"right",label:t.$t("myaccount.operation")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"button-cancel",attrs:{size:"small",plain:""},on:{click:function(n){return t.revokeMiner(e.row.accountRS)}}},[t._v("{{$t('myaccount.cancelAuth')}")])]}}])})],1)],1)])],1),n("el-dialog",{attrs:{visible:t.isShowDialog,"show-close":!1,"destroy-on-close":!0,"custom-class":"vs-dialog",width:"380px"},on:{"update:visible":function(e){t.isShowDialog=e}}},[n("MinerAdd",{attrs:{action:t.minerType,address:t.tempAddress},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}})],1)],1)},a=[],o=n("a34a"),i=n.n(o),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dialog-content__wrap"},[n("div",{staticClass:"dialog-content"},[t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?n("h4",{staticClass:"dialog-content__title"},[t._v(t._s(t.$t("myaccount.auth")))]):n("h4",{staticClass:"dialog-content__title"},[t._v(t._s(t.$t("myaccount.cancelAuth")))]),t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?n("el-form",{ref:"sendForm",staticClass:"dialog-content__body",attrs:{model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{prop:"address"}},[n("el-input",{attrs:{size:"small",placeholder:t.$t("myaccount.errorAddressTips")},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}},[n("template",{slot:"prepend"},[t._v(t._s(t.$t("myaccount.minerAddress")))]),n("div",{attrs:{slot:"suffix"},slot:"suffix"})],2)],1)],1):n("div",{staticClass:"revoke-tips"},[t._v("\n      确认取消该矿工授权\n    ")]),n("div",{staticClass:"dialog-content__footer"},[t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?n("div",{staticClass:"vs-buttons"},[n("el-button",{attrs:{disabled:t.disabledSendButton,type:"primary"},on:{click:t.send}},[t._v(t._s(t.$t("myaccount.ok")))]),n("el-button",{attrs:{disabled:t.disabledSendButton,type:"info"},on:{click:t.hideModal}},[t._v(t._s(t.$t("myaccount.cancel")))])],1):n("div",{staticClass:"vs-buttons"},[n("el-button",{attrs:{disabled:t.disabledSendButton,type:"primary"},on:{click:t.submit}},[t._v("取消授权")]),n("el-button",{attrs:{disabled:t.disabledSendButton,type:"info"},on:{click:t.hideModal}},[t._v("暂不")])],1)])],1)])},c=[],l=n("107c"),u=n("2e3f"),d=n("365c"),p=n("aff9"),m=n("5f72");function f(t,e,n,s,a,o,i){try{var r=t[o](i),c=r.value}catch(l){return void n(l)}r.done?e(c):Promise.resolve(c).then(s,a)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(s,a){var o=t.apply(e,n);function i(t){f(o,s,a,i,r,"next",t)}function r(t){f(o,s,a,i,r,"throw",t)}i(void 0)})}}var v={name:"MinerAdd",props:{action:{type:String,required:!0},address:{type:String}},mixins:[l["a"],u["a"]],data:function(){return{disabledSendButton:!1,form:{address:""}}},computed:{rules:function(){return{address:[{required:!0,message:this.$t("myaccount.inputMinerAddress"),trigger:"blur"},{pattern:/VOL-[a-zA-Z0-9-]+$/,message:this.$t("myaccount.addressTips")}]}},HANDLER_MINER_TYPES:function(){return d["a"]}},methods:{submit:function(){var t=h(i.a.mark(function t(){var e,n,s,a,o;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.address,this.action===d["a"].grantPoolMiner&&(e=this.form.address),console.log(e),n=[{miner:p["a"].createAccountIdByAddress(e)}],s=p["a"].signParams(n,this.$store.state.account.mnemonic),a={account:JSON.stringify(n),pool:this.$store.state.account.address,publicKey:this.$store.state.account.publicKey,signature:s},this.disabledSendButton=!0,o=this.action===d["a"].grantPoolMiner?"增加":"取消",t.prev=8,t.next=11,d["q"](a,this.action);case 11:this.$store.dispatch("getMinerList"),m["Message"].success("".concat(o,"成功")),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](8),m["Message"].warning("".concat(o,"失败"));case 18:return t.prev=18,this.disabledSendButton=!1,this.hideModal(),t.finish(18);case 22:case"end":return t.stop()}},t,this,[[8,15,18,22]])}));function e(){return t.apply(this,arguments)}return e}()}},b=v,g=(n("9d8b"),n("2877")),y=Object(g["a"])(b,r,c,!1,null,"cc6bc00e",null),_=y.exports;function w(t,e,n,s,a,o,i){try{var r=t[o](i),c=r.value}catch(l){return void n(l)}r.done?e(c):Promise.resolve(c).then(s,a)}function $(t){return function(){var e=this,n=arguments;return new Promise(function(s,a){var o=t.apply(e,n);function i(t){w(o,s,a,i,r,"next",t)}function r(t){w(o,s,a,i,r,"throw",t)}i(void 0)})}}var M={name:"MinerManagement",components:{MinerAdd:_},data:function(){return{loading:!1,isShowDialog:!1,tempAddress:"",minerType:d["a"].grantPoolMiner}},computed:{minerList:function(){return this.$store.state.minerList}},created:function(){var t=$(i.a.mark(function t(){return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.$store.dispatch("getMinerList");case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.error(t.t0);case 9:return t.prev=9,this.loading=!1,t.finish(9);case 12:case"end":return t.stop()}},t,this,[[0,6,9,12]])}));function e(){return t.apply(this,arguments)}return e}(),methods:{addMiner:function(){this.minerType=d["a"].grantPoolMiner,this.isShowDialog=!0},revokeMiner:function(t){this.minerType=d["a"].revokePoolMiner,this.tempAddress=t,this.isShowDialog=!0}}},k=M,S=(n("00e6"),Object(g["a"])(k,s,a,!1,null,"d71aa744",null));e["default"]=S.exports},"9d8b":function(t,e,n){"use strict";var s=n("bb6f"),a=n.n(s);a.a},b612:function(t,e,n){"use strict";var s=n("379e"),a=n.n(s);a.a},bb6f:function(t,e,n){},c417:function(t,e,n){}}]);