(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-502464f8"],{"0ac3":function(t,e,n){},"107c":function(t,e,n){"use strict";e["a"]={props:{value:{type:Boolean,required:!0}},methods:{hideModal:function(){this.$emit("input",!1)}}}},"2e3f":function(t,e,n){"use strict";var a=n("aff9"),s=n("5f72"),r=n("365c"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"result"},[n("div",{staticClass:"result-icon__wrap",class:{success:"success"===t.result}},["success"===t.result?n("i",{staticClass:"el-icon-check"}):n("i",{staticClass:"el-icon-close"})]),""!==t.errmsg&&t.gitMerrMg(t.errmsg)?n("span",{staticClass:"result-content"},[t._v(t._s(t.gitMerrMg(t.errmsg)))]):n("span",{staticClass:"result-content"},[t._v(t._s("success"===t.result?t.$t("myaccount.broadcastSuccess"):t.$t("myaccount.broadcastFail")))]),n("el-button",{staticClass:"result-button",attrs:{type:"primary"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("myaccount.close")))])],1)},o=[],c=n("9225"),l=n("0bd9"),u={name:"Result",props:{errmsg:{type:String,default:"",required:!1},title:{type:String,required:!0},result:{type:String,default:"success"}},methods:{gitMerrMg:function(t){var e="";return l["a"][t]&&(e=l["a"][t][c["a"].locale]),e}}},d=u,p=(n("f965"),n("2877")),f=Object(p["a"])(d,i,o,!1,null,"793ee35c",null),m=f.exports;e["a"]={components:{Result:m},data:function(){return{disabledSendButton:!1,isSubmit:!1,result:"",resultTitle:""}},computed:{formattedAccountOverview:function(){return this.$store.getters.formattedAccountOverview}},methods:{send:function(){var t=this;this.$refs.sendForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.submit()})},broadcastTransaction:function(t){var e=this,n=a["a"].signBytes(t,this.$store.state.account.mnemonic),i=a["a"].verifyBytes(n,t,this.$store.state.account.publicKey);if(i){var o=a["a"].signTransactionBytes(t,n);return new Promise(function(t,n){r["d"]({transactionBytes:o}).then(function(n){e.$store.dispatch("getAccountOverview"),t(n)}).catch(n)})}Object(s["Message"])({showClose:!0,message:"签名验证未通过",type:"error"})}}}},4637:function(t,e,n){},"4db3":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"miner-management"},[n("vs-container",[n("vs-header",{staticClass:"vs-header",attrs:{title:t.$t("myaccount.minerManagement")}},[n("el-button",{attrs:{slot:"right",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.addMiner},slot:"right"},[t._v(t._s(t.$t("myaccount.auth")))])],1),n("vs-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"vs-main"},[n("div",{staticClass:"transitions__header"},[n("div",{staticClass:"header__left"},[n("h6",{staticClass:"vs-main__title"},[t._v(t._s(t.$t("myaccount.authMiners")))])]),n("div",{staticClass:"header__right hidden-xs-only"},[n("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.limit,total:t.total,layout:"prev, pager, next, sizes, jumper"},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"update:pageSize":function(e){t.limit=e},"update:page-size":function(e){t.limit=e},"size-change":t.handleChangeCurrent,"current-change":t.handleChangeCurrent}})],1)]),n("div",{staticClass:"el-table__wrap"},[n("el-table",{attrs:{data:t.minerList}},[n("el-table-column",{attrs:{width:"235",align:"left",prop:"accountRS",label:t.$t("myaccount.address")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("router-link",{attrs:{to:"/account/"+e.row.account}},[n("div",{staticClass:"color-text-button-primary"},[t._v("\n                    "+t._s(e.row.accountRS)+"\n                  ")])])]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"totalCap",label:t.$t("myaccount.capacity"),sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.totalCap)+"\n              ")]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"totalPledged",sortable:"",label:t.$t("myaccount.staked")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("toThousand")(t._f("toFixed1")(t._f("formatVol")(e.row.totalPledged))))+"\n              ")]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"blockNum",sortable:"",label:t.$t("myaccount.blockForged")}}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"mineReward",sortable:"",label:t.$t("myaccount.blockEarning")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("toThousand")(t._f("toFixed1")(t._f("formatVol")(e.row.mineReward))))+"\n              ")]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"pledgeRewardBalance",sortable:"",label:t.$t("myaccount.stakingEarning")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("toThousand")(t._f("toFixed1")(t._f("formatVol")(e.row.pledgeRewardBalance))))+"\n              ")]}}])}),n("el-table-column",{attrs:{align:"right",label:t.$t("myaccount.operation")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"button-cancel",attrs:{size:"small",plain:""},on:{click:function(n){return t.revokeMiner(e.row.accountRS)}}},[t._v(t._s(t.$t("myaccount.cancelAuth")))])]}}])})],1)],1)])],1),n("el-dialog",{attrs:{visible:t.isShowDialog,"show-close":!1,"destroy-on-close":!0,"custom-class":"vs-dialog",width:"380px"},on:{"update:visible":function(e){t.isShowDialog=e}}},[n("MinerAdd",{attrs:{action:t.minerType,address:t.tempAddress},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}})],1),n("el-pagination",{staticClass:"hidden-sm-and-up",attrs:{background:"",small:!0,"current-page":t.page,"page-size":t.limit,total:t.total,"pager-count":5,layout:"prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"update:pageSize":function(e){t.limit=e},"update:page-size":function(e){t.limit=e},"size-change":t.handleSizeChange,"current-change":t.handleChangeCurrent}})],1)},s=[],r=n("a34a"),i=n.n(r),o=n("f195"),c=n("365c"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dialog-content__wrap"},[n("div",{staticClass:"dialog-content"},[t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?n("h4",{staticClass:"dialog-content__title"},[t._v(t._s(t.$t("myaccount.auth")))]):n("h4",{staticClass:"dialog-content__title"},[t._v(t._s(t.$t("myaccount.cancelAuth")))]),t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?n("el-form",{ref:"sendForm",staticClass:"dialog-content__body",attrs:{model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{prop:"address"}},[n("el-input",{attrs:{size:"small",placeholder:t.$t("myaccount.errorAddressTips")},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}},[n("template",{slot:"prepend"},[t._v(t._s(t.$t("myaccount.minerAddress")))]),n("div",{attrs:{slot:"suffix"},slot:"suffix"})],2)],1)],1):n("div",{staticClass:"revoke-tips"},[t._v("\n      确认取消该矿工授权\n    ")]),n("div",{staticClass:"dialog-content__footer"},[t.action===t.HANDLER_MINER_TYPES.grantPoolMiner?n("div",{staticClass:"vs-buttons"},[n("el-button",{attrs:{disabled:t.disabledSendButton,type:"primary"},on:{click:t.send}},[t._v(t._s(t.$t("myaccount.ok")))]),n("el-button",{attrs:{disabled:t.disabledSendButton,type:"info"},on:{click:t.hideModal}},[t._v(t._s(t.$t("myaccount.cancel")))])],1):n("div",{staticClass:"vs-buttons"},[n("el-button",{attrs:{disabled:t.disabledSendButton,type:"primary"},on:{click:t.submit}},[t._v("取消授权")]),n("el-button",{attrs:{disabled:t.disabledSendButton,type:"info"},on:{click:t.hideModal}},[t._v("暂不")])],1)])],1)])},u=[],d=n("107c"),p=n("2e3f"),f=n("aff9"),m=n("5f72");function h(t,e,n,a,s,r,i){try{var o=t[r](i),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(a,s)}function g(t){return function(){var e=this,n=arguments;return new Promise(function(a,s){var r=t.apply(e,n);function i(t){h(r,a,s,i,o,"next",t)}function o(t){h(r,a,s,i,o,"throw",t)}i(void 0)})}}var v={name:"MinerAdd",props:{action:{type:String,required:!0},address:{type:String}},mixins:[d["a"],p["a"]],data:function(){return{disabledSendButton:!1,form:{address:""}}},computed:{rules:function(){return{address:[{required:!0,message:this.$t("myaccount.inputMinerAddress"),trigger:"blur"},{pattern:/VOL-[a-zA-Z0-9-]+$/,message:this.$t("myaccount.addressTips")}]}},HANDLER_MINER_TYPES:function(){return c["a"]}},methods:{submit:function(){var t=g(i.a.mark(function t(){var e,n,a,s,r;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.address,this.action===c["a"].grantPoolMiner&&(e=this.form.address),console.log(e),n=[{miner:f["a"].createAccountIdByAddress(e)}],a=f["a"].signParams(n,this.$store.state.account.mnemonic),s={account:JSON.stringify(n),pool:this.$store.state.account.address,publicKey:this.$store.state.account.publicKey,signature:a},this.disabledSendButton=!0,r=this.action===c["a"].grantPoolMiner?"增加":"取消",t.prev=8,t.next=11,c["q"](s,this.action);case 11:this.$store.dispatch("getMinerList"),m["Message"].success("".concat(r,"成功")),o["a"].$emit("upMinerList"),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](8),m["Message"].warning("".concat(r,"失败"));case 19:return t.prev=19,this.disabledSendButton=!1,this.hideModal(),t.finish(19);case 23:case"end":return t.stop()}},t,this,[[8,16,19,23]])}));function e(){return t.apply(this,arguments)}return e}()}},_=v,b=(n("5bcc"),n("2877")),y=Object(b["a"])(_,l,u,!1,null,"88c60512",null),w=y.exports;function M(t,e,n,a,s,r,i){try{var o=t[r](i),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(a,s)}function $(t){return function(){var e=this,n=arguments;return new Promise(function(a,s){var r=t.apply(e,n);function i(t){M(r,a,s,i,o,"next",t)}function o(t){M(r,a,s,i,o,"throw",t)}i(void 0)})}}var C={name:"MinerManagement",components:{MinerAdd:w},data:function(){return{minerList:[],loadingBlock:!1,total:0,limit:20,page:1,loading:!1,isShowDialog:!1,tempAddress:"",minerType:c["a"].grantPoolMiner}},beforeDestroy:function(){o["a"].$off("upMinerList"),o["a"].$off("quickRefresh")},computed:{},created:function(){var t=$(i.a.mark(function t(){return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:o["a"].$on("upMinerList",this.getMinerList),o["a"].$on("quickRefresh",this.getMinerList),this.getMinerList();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{getMinerList:function(){var t=$(i.a.mark(function t(){var e=this;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.delegateYield(i.a.mark(function t(){var n,a,s,r,o,l;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,c["j"]({account:e.$store.state.account.accountId,page:e.page,limit:e.limit});case 3:return n=t.sent,t.next=6,c["m"]({account:e.$store.state.account.accountId});case 6:for(a=t.sent,s=n.data.data.data,r=a.data.data.data,o=function(t){var e=r.filter(function(e){return e.account===s[t].account});e.length>0?s[t]["totalCap"]=e[0].totalCap:s[t]["totalCap"]="-"},l=0;l<s.length;l++)o(l);e.minerList=s,e.total=n.data.data.total;case 13:case"end":return t.stop()}},t)})(),"t0",2);case 2:t.next=6;break;case 4:t.prev=4,t.t1=t["catch"](0);case 6:return t.prev=6,this.loading=!1,t.finish(6);case 9:case"end":return t.stop()}},t,this,[[0,4,6,9]])}));function e(){return t.apply(this,arguments)}return e}(),handleSizeChange:function(t){this.getMinerList()},handleChangeCurrent:function(t){this.getMinerList()},addMiner:function(){this.minerType=c["a"].grantPoolMiner,this.isShowDialog=!0},revokeMiner:function(t){this.minerType=c["a"].revokePoolMiner,this.tempAddress=t,this.isShowDialog=!0}}},k=C,S=(n("7fc1"),Object(b["a"])(k,a,s,!1,null,"bec144b0",null));e["default"]=S.exports},"5bcc":function(t,e,n){"use strict";var a=n("4637"),s=n.n(a);s.a},"6d79":function(t,e,n){},"7fc1":function(t,e,n){"use strict";var a=n("6d79"),s=n.n(a);s.a},f965:function(t,e,n){"use strict";var a=n("0ac3"),s=n.n(a);s.a}}]);